# GenMamba-Flow 默认配置

project:
  name: GenMamba-Flow
  seed: 42
  output_dir: ./outputs
  save_every: 5000
  log_every: 100

# 数据
data:
  image_size: 256
  secret_size: 256
  num_workers: 4
  batch_size: 8
  train_datasets:
    - name: div2k
      root: ./data/placeholder/DIV2K
      split: train
    - name: coco
      root: ./data/placeholder/COCO
      split: train
  secret_datasets:
    - name: paris
      root: ./data/placeholder/Paris_StreetView
    - name: celeba_hq
      root: ./data/placeholder/CelebA-HQ
  num_train_samples: 100000

# RQ-VAE
rq_vae:
  in_channels: 3
  latent_channels: 256
  num_embeddings: 8192
  num_layers: 4
  downsample: 8
  commitment_cost: 0.25

# Tri-Stream Mamba & Rectified Flow
generator:
  in_channels: 3
  model_channels: 256
  out_channels: 3
  num_res_blocks: 2
  channel_mult: [1, 2, 3, 4]
  num_heads: 4
  d_state: 16
  d_conv: 4
  expand: 2
  num_flow_steps: 1000
  text_embed_dim: 768
  secret_embed_dim: 256

# 解码器
decoder:
  in_channels: 3
  hidden_dim: 256
  num_layers: 4
  d_state: 16
  d_conv: 4
  expand: 2
  num_rq_depths: 4
  num_embeddings: 8192

# 干扰流形
interference:
  operators:
    - jpeg
    - gaussian_noise
    - crop
    - blur
  jpeg_quality_range: [30, 90]
  noise_sigma_range: [0.0, 0.2]
  crop_ratio_range: [0.5, 1.0]
  blur_sigma_range: [0.0, 2.0]

# 损失权重
loss:
  lambda_flow: 1.0
  lambda_align: 0.1
  lambda_robust: 0.5
  lambda_commit: 0.25
  align_temperature: 0.07
  contrastive_temperature: 0.07
  robust_depth_weights: [1.0, 0.8, 0.6, 0.4]

# 训练
train:
  epochs: 100
  lr_generator: 1e-4
  lr_decoder: 2e-4
  lr_rq_vae: 1e-4
  weight_decay: 0.01
  warmup_steps: 2000
  grad_clip: 1.0

# 评估
eval:
  num_samples: 1000
  fid_batch_size: 50
  steganalysis_model: srnet
